var defferedPrompt,btnsEnableNotifications=document.querySelectorAll(".enable-notifications"),dbUrl="https://pwagram-16a15.firebaseio.com/",vapidPublicKey="BLBfwcW8oBGt5jKkMpO4ihjW1TEjJJ38Vd3cxV3o7uwbhcOsJSTDRCO5TqGmT8bw5qqGe95SpPd5wADGkKX-Bh4";function displayNotification(){var n={body:"You successfully subscribed to our notifications service!",icon:"/src/images/icons/app-icon-96x96.png",image:"/src/images/sf-boat.jpg",dir:"ltr",lang:"en-US",vibrate:[100,50,200,50,100],badge:"/src/images/icons/app-icon-96x96.png",tag:"confirm-notification",renotify:!0,actions:[{action:"confirm",title:"Ok",icon:"/src/images/icons/app-icon-96x96.png"},{action:"cancel",title:"Cancel",icon:"/src/images/icons/app-icon-96x96.png"}]};"serviceWorker"in navigator?navigator.serviceWorker.ready.then(function(i){console.log("Notifications subscription from SW"),i.showNotification("Successfully subscribed!",n)}):new Notification("Successfully subscribed!",n)}function configurePushSubscription(){var o;"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(i){return(o=i).pushManager.getSubscription()}).then(function(i){if(null===i){var n=urlBase64ToUint8Array(vapidPublicKey);return o.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:n})}}).then(function(i){return fetch(dbUrl+"subs.json",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(i)})}).then(function(i){i.ok&&displayNotification()}).catch(function(i){console.log("Subscription failed",i)})}function askForPermission(){Notification.requestPermission(function(i){"granted"!==i?console.log("No permission granted!"):configurePushSubscription()})}if("serviceWorker"in navigator&&navigator.serviceWorker.register("/service-worker.js").then(function(){console.log("Service worker registered!")}).catch(function(i){console.log(i)}),window.addEventListener("beforeinstallprompt",function(i){return console.log("[app] beforeinstallprompt..."),i.preventDefault(),defferedPrompt=i,!1}),"Notification"in window&&"serviceWorker"in navigator)for(var i=0;i<btnsEnableNotifications.length;i++)btnsEnableNotifications[i].addEventListener("click",askForPermission);